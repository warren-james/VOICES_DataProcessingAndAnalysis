"0","jaccard_sim <- function(listA, listB){"
"0","  bothPos <- sum(listA + listB == 2)"
"0","  bothDif <- sum(listA != listB)"
"0","  "
"0","  return(round(bothPos/(bothPos + bothDif), 3))"
"0","}"
"0",""
"0","# Make a figure using the jaccard value... "
"0","# not sure why, but it might be interesting to see? "
"0","# A jaccard index will be better when there are many items and few positive responses"
"0","# I don't think we suffer from that problem though? "
"0","# Also, this is a very naive way to compare similarity scores since there are probably some components "
"0","# that mean a service is more similar than another? I know what that means just now, and hopefully will in the future"
"0","df_SurveyResps %>% "
"0","  select(ID, uniqueQs) %>% "
"0","  gather(2:ncol(.), "
"0","         key = ""QuestionX"", "
"0","         value = ""ResponseX"") %>% "
"0","  left_join(df_SurveyResps %>% "
"0","              select(ID, uniqueQs)) %>% "
"0","  gather(4:ncol(.), "
"0","         key = ""QuestionY"", "
"0","         value = ""ResponseY"") %>% "
"0","  drop_na() %>%"
"0","  mutate(match = as.numeric(ResponseX == ResponseY)) %>% "
"0","  group_by(QuestionX, QuestionY) %>% "
"0","  mutate(jac = jaccard_sim(ResponseX, ResponseY)) %>% "
"0","  ggplot(aes(QuestionX, QuestionY, fill = jac)) + "
"0","  geom_tile(colour = ""white"", "
"0","            lwd = 1.5) + "
"0","  geom_text(aes(label = round(jac, 3), "
"0","                colour = abs(jac - .5) > .25)) + "
"0","  scale_y_discrete("""", limits = rev) +"
"0","  scale_x_discrete("""") +"
"0","  scale_colour_manual(values = c(""black"", ""white"")) +"
"0","  # scale_fill_gradient2(space = ""Lab"") +"
"0","  scale_fill_gradient2(low = ""#b71c1c"", "
"0","                       mid = ""white"", "
"0","                       high =  ""#1a237e"", "
"0","                       midpoint = .5, "
"0","                       space = ""Lab"") +"
"0","  coord_cartesian(expand = F) +"
"0","  ggtitle(""Jaccard score"") +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),"
"0","        legend.position = ""none"", "
"0","        axis.text = element_text(size = min(textSize) - 2))"
