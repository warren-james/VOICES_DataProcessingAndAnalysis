---
title: "Lancet Paper supplementary material"
output: 
  bookdown::html_document2:
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: no
    theme: flatly
    highlight: kate 
    fig.caption: yes 
    tables: true 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.align = "center",
  fig.width = 12,
  fig.height = 8
)
```

```{css, echo = F}
<!-- .header1 { -->
<!-- color: #8a2587; -->
<!-- } -->

.caption {
margin: auto;
text-align: left;
}
```

```{r, warning = F, message = F, include = F, echo = F}
myColour <- "#8a2587"
```

# Introduction

The supplementary material for the lancet paper looking at how different service components effect key clinical outcomes and health care use. This additional material demonstrates on a set of synthetic data, the data processing and analysis carried out for the paper "X". 

# Library 

These are the packages that were used in the analysis of the data. Please note, the version numbers might be different, but the methods are still the same. 

```{r load libraries, warning = F, message = F}
# packages for analysis and processing
library(tidyverse)
library(tidybayes)
library(brms)
library(lubridate)

# packages for figures and tables in this document 
library(see)
library(ggridges)
```

```{r figure settings, echo = F}
# Sort out the theme
textSize <- 17:20
theme_set(theme_bw())
theme_update(
  title = element_text(size = textSize[3]),
  axis.text = element_text(size = textSize[2]),
  axis.title = element_text(size = textSize[3]),
  legend.text = element_text(size = textSize[1])
)
```

# Load data 

This loads in a dataset for the posterior samples from one of the models fit in the paper "X". This is from the multivariable analysis regarding the rates of Serious Infection. The data is arranged in a long format with the `iter` column linking draws from the posterior across the different parameters. Due to the link functions used in the `brms` package when fitting a negative binomial model, all coefficients for the mu value are on a log scale. For simplicity, coefficients for socio demographic features are not included in this dataset. 

```{r load data, message = F}
df_SI <- read_csv("data/df_SI.csv")

head(df_SI)
```

There are a few rows that aren't needed for this demonstration, so the dataset will tidied up to make things easier to generate a synthetic dataset. 

```{r clean up data}
df_SI %>% 
  select(iter, param, Coef) %>% 
  spread(param, Coef)
```





